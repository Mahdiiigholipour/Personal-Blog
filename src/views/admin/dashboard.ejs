<%- include("../partials/header", { pageTitle: "Admin Dashboard" }) %>

<h1>Admin Dashboard</h1>
<p><a href="/admin/add" class="btn btn-edit">+ Add New Article</a></p>

<ul class="article-list">
  <% articles.forEach(article => { const dateObj = new
  Date(+article.publishingDate); const formattedDate =
  dateObj.toLocaleDateString("en-US", { year: "numeric", month: "long", day:
  "numeric" }); %>
  <li>
    <span class="article-title"><%= article.title %></span>
    <span class="article-date"><%= formattedDate %></span>
    <div>
      <a href="/admin/edit/<%= article.id %>" class="btn btn-edit"> Edit </a>
      <form
        id="deleteForm-<%= article.id %>"
        action="/admin/delete/<%= article.id %>"
        method="POST"
        style="display: inline"
      >
        <button type="submit" class="btn btn-delete">Delete</button>
      </form>
    </div>
  </li>
  <% }) %>
</ul>
<script>
  document.querySelectorAll("form[id^='deleteForm']").forEach((form) => {
    form.addEventListener("submit", function (e) {
      const confirmed = confirm(
        "Are you sure you want to delete this article?"
      );
      if (!confirmed) {
        e.preventDefault(); // جلو ارسال فرم رو بگیر
      }
    });
  });
</script>

<%- include("../partials/footer") %>
